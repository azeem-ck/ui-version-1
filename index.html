<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Warehouse Bin Decommissioning UI</title>
<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>
<!-- Google Fonts: Inter -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
/* Define custom color variables */
:root {
--bg-main: #F0EFE9;
--primary-dark: #003C3C;
--primary-darkest: #0D2021;
--color-inactive-bg: #e5e7eb;

/* Order-specific Colors (used for visual differentiation of SKUs in bins) */
--order-1-bg: #FEF3C7; /* Amber 100 */
--order-2-bg: #DBEAFE; /* Blue 200 */
--order-3-bg: #FCE7F3; /* Pink 100 */
}

body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg-main);
    color: var(--primary-darkest);
}

/* --- Compartment Item Styling --- */
.item-inactive { background-color: var(--color-inactive-bg); }
.order-1 { background-color: var(--order-1-bg); }
.order-2 { background-color: var(--order-2-bg); }
.order-3 { background-color: var(--order-3-bg); }


/* --- Bin Location Styling --- */
.bin-location {
    cursor: pointer;
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
}
.bin-location:hover {
    transform: translateY(-4px);
    box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
}

/* General Styles */
.nav-link { color: var(--primary-dark); }
.nav-link:hover { color: var(--primary-darkest); background-color: #e5e7eb; }
.nav-link-active { background-color: var(--primary-dark); color: white; }

/* --- Decommission Animation --- */
.animated-arrow {
    animation: move-arrow 1.5s ease-in-out infinite;
}

@keyframes move-arrow {
    0%, 100% {
        transform: translateX(0);
        opacity: 0.8;
    }
    50% {
        transform: translateX(15px);
        opacity: 1;
    }
}
</style>
</head>
<body class="antialiased">

<div id="root" class="flex flex-col h-screen">
<!-- Header -->
<header class="bg-white border-b border-gray-200 shadow-sm">
    <div class="container mx-auto px-4">
        <div class="flex items-center justify-between h-16">
            <div class="flex items-center space-x-8">
                <img src="https://placehold.co/150x40/003C3C/FFFFFF?text=Cartesian+Kinetics" alt="Cartesian Kinetics Logo" class="h-10">
                <nav class="hidden md:flex items-center space-x-1">
                    <a href="#" class="px-3 py-2 text-sm font-semibold rounded-md nav-link-active">Decommission</a>
                    <a href="#" class="px-3 py-2 text-sm font-medium rounded-md nav-link">Inbounds</a>
                    <a href="#" class="px-3 py-2 text-sm font-medium rounded-md nav-link">Fulfillment</a>
                </nav>
            </div>
            <div class="flex items-center space-x-4">
                <div class="text-right text-xs text-primary-dark">
                    <div id="date-time">01:50 PM Wed 2025</div>
                    <div>John Doe</div>
                </div>
                <a href="#" class="cursor-pointer">
                    <img src="https://placehold.co/40x40/EFEFEF/333333?text=JD" alt="User Avatar" class="w-10 h-10 rounded-full"
                    onerror="this.onerror=null;this.src='https://placehold.co/40x40/EFEFEF/333333?text=JD';">
                </a>
            </div>
        </div>
    </div>
</header>

<!-- Main Content -->
<main class="flex-grow p-4 md:p-6">
    <div class="container mx-auto">
        <div class="flex justify-between items-center mb-4">
             <h2 class="text-lg font-semibold text-primary-darkest">Warehouse Bins</h2>
             <button id="reset-wave-btn" class="px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700">Reset Wave</button>
        </div>
        <p class="text-sm text-gray-600 mb-4">Click on a bin to begin the decommissioning process.</p>
        <div id="bins-grid" class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-12 gap-4">
            <!-- Bins will be dynamically populated by the script -->
        </div>
    </div>
</main>
</div>

<!-- Decommission Modal Dialog -->
<div id="decommission-modal" class="hidden fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
    <div class="bg-white rounded-2xl shadow-xl w-full max-w-6xl mx-auto">
        <div class="p-6 md:p-8 grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">

            <!-- ===== Left Pane: Tote Info ===== -->
            <div class="bg-gray-50 rounded-lg p-4 flex flex-col border border-gray-200">
                <h2 class="text-xl font-bold text-primary-darkest mb-4 border-b pb-2">Tote Information</h2>
                <div>
                    <p class="text-sm text-gray-500 uppercase font-semibold">Tote ID</p>
                    <h3 id="modal-tote-id" class="text-2xl font-semibold text-gray-800"></h3>
                </div>
                <div class="mt-4 flex-grow">
                    <p class="text-sm text-gray-500 uppercase font-semibold mb-2">Contents</p>
                    <ul id="modal-sku-list" class="space-y-3 overflow-y-auto max-h-80 pr-2">
                        <!-- SKU list will be populated here -->
                    </ul>
                </div>
            </div>

            <!-- ===== Middle Pane: SKU Images ===== -->
            <div class="bg-gray-50 rounded-lg p-4 flex flex-col border border-gray-200">
                <h2 class="text-xl font-bold text-primary-darkest mb-4 border-b pb-2">SKU Images</h2>
                <div id="modal-sku-images" class="grid grid-cols-2 gap-4 flex-grow content-start overflow-y-auto max-h-96">
                    <!-- SKU images will be populated here -->
                </div>
            </div>

            <!-- ===== Right Pane: Action ===== -->
            <div class="bg-gray-50 rounded-lg p-4 flex flex-col border border-gray-200">
                <h2 class="text-xl font-bold text-primary-darkest mb-4 border-b pb-2">Action Required</h2>
                <div class="flex-grow flex flex-col items-center justify-center">
                     <div class="relative w-40 h-56">
                        <!-- Blue Box -->
                        <div class="bg-blue-500 rounded-lg w-full h-full flex items-center justify-center p-4 shadow-lg">
                            <span class="text-white text-lg font-semibold text-center leading-tight">Please take the tote out</span>
                        </div>
                        <!-- Animated Arrow SVG -->
                         <svg class="animated-arrow absolute w-24 h-24 text-red-500" style="top: 5rem; right: -5rem;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="3" stroke="currentColor">
                           <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12h15m0 0l-6.75-6.75M19.5 12l-6.75 6.75" />
                        </svg>
                    </div>
                    <p class="text-center mt-8 text-sm font-semibold text-primary-dark">Remove tote from its location.</p>
                </div>
                <div class="mt-4">
                    <button id="modal-decommission-btn" class="w-full text-center py-4 px-4 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 text-lg transition-colors">Decommission</button>
                    <p class="text-xs text-center text-gray-500 mt-2">Acknowledge only after removing the tote.</p>
                </div>
            </div>

        </div>
    </div>
</div>


<script>
document.addEventListener('DOMContentLoaded', () => {
    const binsGrid = document.getElementById('bins-grid');
    const modal = document.getElementById('decommission-modal');
    const dateTimeElement = document.getElementById('date-time');
    const resetWaveBtn = document.getElementById('reset-wave-btn');

    let binData = [];

    // --- DATE & TIME --- //
    function updateDateTime() {
        const now = new Date();
        const options = { weekday: 'short', hour: '2-digit', minute: '2-digit', hour12: true };
        const timeString = now.toLocaleTimeString('en-US', options).replace(' ', '');
        const yearString = now.getFullYear();
        dateTimeElement.textContent = `${timeString} ${now.toLocaleDateString('en-US', {weekday:'short'})} ${yearString}`;
    }

    // --- DATA GENERATION --- //
    function generateSku() {
        const randomNum = Math.floor(Math.random() * 100) + 1;
        return {
            name: `Industrial Widget ${randomNum}`,
            id: `SKU-${Math.random().toString(36).slice(2, 11).toUpperCase()}`,
            imageUrl: `https://placehold.co/200x200/EFEFEF/333333?text=SKU-${randomNum}`,
            quantity: Math.floor(Math.random() * 20) + 1,
        };
    }

    function generateNewWave() {
        binData = [];
        const binTypes = ['1-compartment', '2-compartment', '4-compartment', 'empty'];
        const itemColors = ['order-1', 'order-2', 'order-3'];

        for (let i = 1; i <= 12; i++) {
            const binLocationId = `${i}.1.1.`;
            const randomType = binTypes[Math.floor(Math.random() * binTypes.length)];
            const newBin = { id: binLocationId, type: randomType, items: [] };

            if (randomType !== 'empty') {
                let compartmentCount = 0;
                if (randomType === '1-compartment') compartmentCount = 1;
                if (randomType === '2-compartment') compartmentCount = 2;
                if (randomType === '4-compartment') compartmentCount = 4;
                
                // Decide if this bin should be filled. Let's use a 70% chance.
                const shouldFillBin = Math.random() > 0.3;

                if (shouldFillBin) {
                    for (let j = 0; j < compartmentCount; j++) {
                        // Fill every compartment
                        newBin.items.push({
                            compartment: j,
                            sku: generateSku(),
                            colorClass: itemColors[Math.floor(Math.random() * itemColors.length)],
                        });
                    }
                }
                // If shouldFillBin is false, the items array remains empty, so the bin is not shown with items.
            }
            binData.push(newBin);
        }
        renderBins();
    }


    // --- UI RENDERING --- //
    function renderBins() {
        binsGrid.innerHTML = '';

        binData.forEach(data => {
            const binWrapper = document.createElement('div');
            binWrapper.dataset.binId = data.id;

            if (data.type === 'empty' || data.items.length === 0) {
                binWrapper.className = 'bg-white/60 border border-gray-300 rounded-lg p-3 flex flex-col aspect-[2/4]';
                binWrapper.innerHTML = `<div class="flex-grow"></div>`;
            } else {
                binWrapper.className = 'bin-location bg-white rounded-lg p-1 flex flex-col aspect-[2/4] border border-gray-300 shadow-sm';
                let gridClass = '', compartmentCount = 0;
                if (data.type === '1-compartment') { gridClass = 'grid-cols-1 grid-rows-1'; compartmentCount = 1; }
                if (data.type === '2-compartment') { gridClass = 'grid-cols-2 grid-rows-1'; compartmentCount = 2; }
                if (data.type === '4-compartment') { gridClass = 'grid-cols-2 grid-rows-2'; compartmentCount = 4; }

                let compartmentsHtml = '';
                for (let i = 0; i < compartmentCount; i++) {
                    const itemData = data.items.find(item => item.compartment === i);
                    if (itemData) {
                        compartmentsHtml += `<div class="rounded-md ${itemData.colorClass}"></div>`;
                    } else {
                        compartmentsHtml += `<div class="rounded-md item-inactive"></div>`;
                    }
                }
                binWrapper.innerHTML = `<div class="flex-grow grid ${gridClass} gap-1">${compartmentsHtml}</div>`;

                // Add click listener for decommissioning
                binWrapper.addEventListener('click', () => {
                    openDecommissionModal(data.id);
                });
            }

            binWrapper.innerHTML += `<p class="text-xs text-center text-primary-dark mt-2">Bin Location:<br><span class="font-semibold">${data.id}</span></p>`;
            binsGrid.appendChild(binWrapper);
        });
    }

    // --- MODAL LOGIC --- //
    function openDecommissionModal(binId) {
        const bin = binData.find(b => b.id === binId);
        if (!bin) return;

        // --- Get Modal DOM Elements ---
        const toteIdEl = document.getElementById('modal-tote-id');
        const skuListEl = document.getElementById('modal-sku-list');
        const skuImagesEl = document.getElementById('modal-sku-images');
        const decommissionBtn = document.getElementById('modal-decommission-btn');

        // --- Populate Modal ---
        toteIdEl.textContent = bin.id;
        skuListEl.innerHTML = '';
        skuImagesEl.innerHTML = '';

        if (bin.items.length === 0) {
            skuListEl.innerHTML = `<li class="text-gray-500">No items in this tote.</li>`;
        }

        bin.items.forEach(item => {
            // Populate SKU list
            const listItem = document.createElement('li');
            listItem.className = 'flex justify-between items-center bg-white p-2 rounded-md shadow-sm';
            listItem.innerHTML = `
                <div>
                    <p class="font-semibold text-primary-darkest">${item.sku.name}</p>
                    <p class="text-xs text-gray-500">${item.sku.id}</p>
                </div>
                <div class="text-right">
                     <p class="font-bold text-lg text-primary-darkest">${item.sku.quantity}</p>
                     <p class="text-xs text-gray-500">QTY</p>
                </div>
            `;
            skuListEl.appendChild(listItem);

            // Populate SKU images
            const imageContainer = document.createElement('div');
            imageContainer.className = 'relative';
            imageContainer.innerHTML = `
                <img src="${item.sku.imageUrl}" alt="${item.sku.name}" class="rounded-lg w-full aspect-square object-cover bg-gray-200">
                <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs text-center p-1 rounded-b-lg font-semibold">
                    ${item.sku.name}
                </div>
            `;
            skuImagesEl.appendChild(imageContainer);
        });

        // --- Setup Button ---
        decommissionBtn.onclick = () => {
            const binIndex = binData.findIndex(b => b.id === binId);
            if (binIndex > -1) {
                binData[binIndex].type = 'empty';
                binData[binIndex].items = [];
            }
            closeModal();
            renderBins();
        };

        modal.classList.remove('hidden');
    }

    function closeModal() {
        modal.classList.add('hidden');
    }

    // --- GLOBAL EVENT LISTENERS --- //
    modal.addEventListener('click', e => {
        if (e.target.id === 'decommission-modal') {
            closeModal();
        }
    });

    resetWaveBtn.addEventListener('click', generateNewWave);

    // --- START APP --- //
    generateNewWave();
    updateDateTime();
    setInterval(updateDateTime, 60000); // Update every minute
});
</script>

</body>
</html>
